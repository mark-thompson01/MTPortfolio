<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setting Up Active Directory</title>
   <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background-color: #1e1e1e;
      color: #e0e0e0;
      padding: 2rem;
      margin: 20px; 
    }
    h1, h2 {
      color: #ADD8E6;
    }
    code {
      background-color: #333;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      display: block;
      white-space: pre-wrap;
      margin: 0.5rem 0;
    }
    .section {
      margin-bottom: 30px;
    }
    .event-id { font-weight: bold; color: #0057e7; }
    ul { margin-bottom: 20px; }
       img {
         display: block;
         margin: 20px 0;
         width: 750px;
         height: 550px;
         border: 1px solid #444;
         border-radius: 5px;
    }
        a {
      color: #1e90ff;
      text-decoration: none;
    }
    a:hover {
      color: #ff7f50;
      text-decoration: underline;
    }
  </style>
</head>
<body>
<h1>Managing AD & GP with PowerShell</h1><br>


<h2>Preparing PowerShell Environment</h2>
<p>Before we can administrate in Active Directory and Group Policy through PowerShell, the <strong>Active Directory</strong> PowerShell module needs to be imported. The PowerShell Active Directory module is a collection of cmdlets that are designed to manage and administrate <strong>Active Directory Domain Services - (AD DS)</strong> and <strong>Active Directory Lightweight Directory Services (AD LDS) environments.</strong></p>
<img src="Images/ps1.PNG" alt="ps1.PNG" style="width:700px; height:200px;"><br><br>

<h2>Single User Account Creation</h2>
<p><strong>1.</strong> To create a single AD user account, a template in a .ps1 file can be ready to go, where you can edit the attributes and run the script to quickly create the account.</p>
<img src="Images/ps4.png" alt="ps4.png">
<img src="Images/ps5.PNG" alt="ps5.PNG" style="width:800px; height:300px;"><br><br>


<h2>Batch User Creation in AD</h2>
<p><strong>1.</strong> The first step is to create a CSV, for this example, I'm using Notepad++ to create a .csv file with the following attributes.</p>
<img src="Images/csv0.png" alt="csv0.png" style="width:900px; height:200px;"><br>
<p><strong>2.</strong> Then I'm going to use this script to import the csv file to create two new user accounts in Active Directory.</p>
<img src="Images/ScriptCode0.png" alt="ScriptCode0.png"><br>
<p><strong>3.</strong> Two new user accounts in <strong>Active Directory Users and Computers</strong> in the <strong>TestUsers OU</strong>.</p>
<img src="Images/csv00.PNG" alt="csv00.PNG" style="width:800px; height:300px;"><br><br>

<h2>Resetting User Account Password</h2>
<p><strong>1.</strong> To reset a single user account password, the following cmdlet can be run.</p>
<img src="Images/ps2.PNG" alt="ps2.PNG" style="width:1000px; height:200px;"><br>

<P><strong>2.</strong> Force user to change password at next logon.</P>
<img src="Images/ps3.PNG" alt="ps3.PNG" style="width:900px; height:200px;"><br><br><br>

<h2>Apply a GPO to a User via OU</h2>
<p><strong>1.</strong> If the user account is in a specific OU, you can link an existing GPO to that OU using:</p>
<p>THis links the <strong>Disable Control Panel</strong> GPO to the <strong>TestUsers</strong> OU, which applies to all users in that OU - unless Security Filtering is used to limit scope.</p>
<img src="Images/GPO1.PNG" alt="GPO1.PNG" style="width:900px; height:200px;"><br><br>

<h2>Use Security Filtering to Target a Specific User</h2>
<p><strong>1.</strong> First, grant the GPO permission to a specific user account:</p>
<p>This gives the user <strong>Read</strong> and <strong>Apply Group Policy</strong> permissions.</p>
<img src="Images/GPO2.PNG" alt="GPO2.PNG" style="width:1000px; height:500px;">
<img src="Images/GPO3.PNG" alt="GPO3.PNG"><br><br>

<p><strong>2.</strong> <strong>Optional:</strong> Remove <strong>Authenticated Users</strong> from security filtering if you want only this user to be effected.</p>
<p>Be careful removing Authenticated Users - only do this if you're explicitly assigned permissions to the correct scope.</p>
<img src="Images/GPO4.PNG" alt="GPO4.PNG" style="width:900px; height:200px;"><br><br>




    
    





















 
 <a href="../index.html">Back to Home</a>


</body>
</html>
