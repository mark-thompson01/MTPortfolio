<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setting up Group Policy</title>
   <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background-color: #1e1e1e;
      color: #e0e0e0;
      padding: 2rem;
      margin: 20px; 
    }
    h1, h2, h3 {
      color: #ADD8E6;
    }
    code {
      background-color: #333;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      display: block;
      white-space: pre-wrap;
      margin: 0.5rem 0;
    }
    .section {
      margin-bottom: 30px;
    }
    .event-id { font-weight: bold; color: #0057e7; }
    ul { margin-bottom: 20px; }
           img {
         display: block;
         margin: 20px 0;
         width: 750px;
         height: 550px;
         border: 1px solid #444;
         border-radius: 5px;
    }
  </style>
</head>

<body>
    <h1>Setting up Group Policy</h1>

    <p>The following demonstration outlines how to set up basic GPOs and applying them to an Active Directory user and computer account.</p><br>

    <h2>GPO Applied to AD User Account</h2>

    <h3><strong>1.</strong> Hide the "Run" Command from Start Menu via Group Policy (User Account GPO)</h3>
    <p><strong>Objective:</strong> Prevent users from accessing the <strong>Run</strong> dialog <strong>(Win + R)</strong>, which can limit their ability to manually launch control panels, scripts, or unauthorized apps.</p>
    <p><strong>1.</strong> In <strong>Server Manager</strong> click on the <strong>Tools</strong> drop-down in the upper right, then select <strong>Group Policy Management</strong>.</p>
    <img src="Images/DR1.PNG" alt="DR1.PNG"><br>
    <p><strong>2.</strong> In <strong>Group Policy Management</strong> Expand the Forest domain.</p>
    <img src="Images/DR2.PNG" alt="DR2.PNG" style="width:800px; height:400px;"><br>
    <p><strong>3.</strong> Right-click on the domain and select <strong>Create a GPO in this domain, and Link it here...</strong></p>
    <img src="Images/DR3.PNG" alt="DR3.PNG"><br>
    <p><strong>4.</strong> Enter in a name for the <strong>New GPO</strong>, then click <strong>Ok</strong>.</p>
    <img src="Images/DR4.PNG" alt="DR4.PNG" style="width:550px; height:250px;"><br>
    <p><strong>5.</strong> Right-click on the New GPO in <strong>Group Policy Management</strong> and select <strong>Edit</strong>.</p>
    <img src="Images/DR5.PNG" alt="DR5.PNG"><br>
    <p><strong>6.</strong> Under <strong>User Configuration</strong> navigate to <strong>User Configuration > Policies > Administraive Templates > Start Menu and Taskbar, then select</strong> <strong>Remove Run menu from Start Menu</strong>.</p>
    <img src="Images/DR6.PNG" alt="DR6.PNG"><br>
    <p><strong>7.</strong> Select <strong>Enabled</strong>, click <strong>Apply</strong>, then <strong>Ok</strong>.</p>
    <img src="Images/DR7.PNG" alt="DR7.PNG"><br><br><br><br>
    
    
        
    

    <h3><strong>2.</strong> Disable Control Panel and Settings App via Group Policy (User Account GPO)</h3>
    <p><strong>Objective:</strong> Prevent a user from accessing the Control Panel and Settings on a Windows domain-joined computer</p><br>

    <p><strong>1.</strong> In Server Manager click on the <strong>Tools</strong> drop-down in the upper right, then select <strong>Group Policy Management</strong>.</p>
    <img src="Images/GP1.PNG" alt="GP1.PNG">
    <img src="Images/GP2.PNG" alt="GP1.PNG"><br>
    <p><strong>2.</strong> Expand the <strong>Forest Domain</strong> on the leftt menu of Group Policy Management. Then right-click on the domain name to select "<strong>Create a GPO in this domain, and link it here.</strong></p>
    <img src="Images/GP3.PNG" alt="GP3.PNG"><br>
    <p><strong>3.</strong> Assign a name to the new GPO, then click <strong>Ok</strong>.</p>
    <img src="Images/GP4.PNG" alt="GP4.PNG"><br>
    <p><strong>4.</strong> The new GPO will then be listed in the hierarchical stucture on the left. Right-click, the select <strong>Edit</strong>.</p>
    <img src="Images/GP5.PNG" alt="GP5.PNG"><br>
    <p><strong>5.</strong> The <strong>Group Policy Management Editor</strong> window will come up. Navigate <strong>User Configuration > Policies > Administrative Template Policy definitions > Control Panel.</strong></p>
    <img src="Images/GP6.PNG" alt="GP6.PNG"><br>
    <p><strong>6.</strong> Click on <strong>Prohibit access to Control Panel and PC settings.</strong></p>
    <img src="Images/GP7.PNG" alt="Images/GP7.PNG"><br>
    <p><strong>7.</strong> Click on <strong>Enabled</strong> to the left. Then click <strong>Ok</strong>.</p>
    <img src="Images/GP8.PNG" alt="GP8.PNG"><br><br><br><br><br>
    
    
    
    <h2>GPO Applied to AD Computer Account</h2>
    <h3><strong>1.</strong> Account Lockout Policy via Group Policy (User Account GPO)</h3>
    <p>One of the first GPO's that should be created upon spinning up a domain controller is setting the <strong>Active Directory User Account Lockout Policy</strong>.</p><br>
    <p><strong>1.</strong> In <strongL>Server Manager</strong> click on the <strong>Tools</strong> drop-down in the upper right, then select <strong>Group Policy Management</strong>.</p>
    <img src="Images/AccountL1.PNG" alt="AccountL1.PNG"><br>
    <p><strong>2.</strong> In <strong>Group Policy Management</strong> Expand the <strong>Forest Domain</strong> on the left menu, then click <strong>Create a GPO in this domain, and link it here.</strong>.</p>
    <img src="Images/AccountL2.PNG" alt="AccountL2.PNG"><br>
    <p><strong>3.</strong> Name the <strong>New GPO</strong> Account Lockout Policy.</p>
    <img src="Images/AccountL3.PNG" alt="AccountL3.PNG" style="width:600px; height:200px;"><br>
    <p><strong>4.</strong> The new GPO will then be listed in the hierarchical structure on the left. Right-click, then select <strong>Edit</strong>.</p>
    <img src="Images/AccountL4.PNG" alt="AccountL4.PNG"><br>
    <p><strong>5.</strong> The <strong>Group Policy Management Editor</strong> window will come up. Navigate to <strong>Computer Configuration > Policies > Windows Settings > Account Policies > Account Lockout Policy</strong>.</p>
    <img src="Images/AccountL5.PNG" alt="AccountL5.PNG" style="width:800px; height:400px;"><br>
    <p><strong>6.</strong> Click on <strong>Account lockout threshold</strong> to the right.</p>
    <img src="Images/AccountL6.PNG" alt="AccountL6.PNG"><br>
    <p><strong>7.</strong> Configure the <strong>Account lockout threshold Properties</strong>. For this example, I'm setting the duration to 3, click <strong>Apply</strong>, the <strong>Ok</strong>.</p>
    <img src="Images/AccountL7.PNG" alt="AccountL7.PNG"><br><br><br>



    
    <h3><strong>2.</strong> Adding a Custom Logon Message to domain connnected computers via Group Policy (User Account GPO)</h3>
    <p><strong>Objective:</strong> Setting up a Custom Logon Message</p>

    <p><strong>1.</strong> Go back into <strong>Server Manager > Tools</strong>, then select <strong>Group Policy Management</strong>.</p>
    <p><strong>2.</strong> Right-click on Domain.1.microsoft.com domain entry under the forest hierarchy, and select <strong>Create a GPOin this domain and link it here...</strong>.</p>
    <img src="Images/CL1.PNG" alt="CL1.PNG"><br>
    <p><strong>3.</strong> This one will be named <strong>Custom Logon Message</strong>, then click <strong>Ok</strong>.</p><br>
    <img src="Images/CL2.PNG" alt="CL2.PNG"><br>
    <p><strong>4.</strong> Right-click on the new created GPO and select <strong>Edit</strong>.</p>
    <img src="Images/CL3.PNG" alt="CL3.PNG"><br>
    <p><strong>5.</strong> In <strong>Group Policy Management Editor</strong>, Under <strong>Computer Configuration</strong> navigate to <strong>Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options</strong>. Then select <strong>Interactive Logon: Message Title for users attempting to log on.</strong>.</p>
    <img src="Images/CL4.PNG" alt="CL4.PNG"><br>
    <p><strong>6.</strong> Set up the <strong>Message Title</strong>, then click <strong>Apply</strong> then <strong>Ok</strong>.</p>
    <img src="Images/CL5.PNG" alt="CL5.PNG"><br>
    <p><strong>7.</strong></p></p><br><br><br>

    <h3><strong>3.</strong> Disable USB Storage Devices to domain connected computers via Group Policy (User Account GPO)</h3>
    <p><strong>Objective:</strong> Prevent all USB mass storage devices (e.g., flash drives) from working on domain-joined computers App via Group Policy (User Account GPO).</p><br>
    <p><strong>1.</strong> In <strong>Group Policy Editor</strong> navigate to <strong>Computer Configuration > Policies > Administrative Templates > System > Removable Storage Access</strong>. Then click-on <strong>All Removeable Storage classes: Deny all access.</strong></p>
    <img src="Images/RSD1.PNG" alt="RSD1.PNG"><br>
    <p><strong>2.</strong> Select <strong>Enabled</strong> then click <strong>Ok</strong></p>
    <img src="Images/RSD2.PNG" alt="RSD2.PNG"><br><br><br><br>

    <h2>Create a Security Group in Active Directory and link it to a GPO</h2>
    <h3>Step 1: Create a Security Group in Active Directory</h3>
    <p><strong>1.</strong> Open <strong>Active Directory Users and Computersd (dsa.msc)</strong></p>
    <img src="Images/SG1.PNG" alt="SG1.PNG" style="width:400px; height:600px;"><br>
    <p><strong>2.</strong> Navigate to the OU where you want the group stored.</p>
    <p><strong>3.</strong> Right-click on the OU > <strong>New > Group</strong></p>
    <img src="Images/SG2.PNG" alt="SG1.PNG">
    <ul>
        <li>Name it: e.g., <strong>GPO Testers</strong></li>
        <li>Group Type:<strong>Security</strong></li>
        <li>Scope: <strong>Global</strong> (default is fine)</li>
    </ul>
    <p><strong>4.</strong> Click <strong>Ok</strong></p>
    <img src="Images/SG3.PNG" alt="SG3.PNG" style="width:250px; height:400px;">

    <p><strong>Result:</strong> There's now a New Security Group in ADUC.</p><br><br>

    <h3>Step 2: Add Users to the Group</h3>
    <p><strong>1.</strong> Double-click the group you just created</p>
    <p><strong>2.</strong> Go to the <strong>Members</strong> tab</p>
    <p><strong>3.</strong> Click <strong>Add</strong>, and select the users you want the GPO to apply to</p>
    <p><strong>4.</strong>Click <strong>Ok</strong></p>
    <img src="Images/SG4.PNG" alt="SG4.PNG">
    <img src="Images/SG5.PNG" alt="SG5.PNG">
    
    <p><strong>Result:</strong> Those users are now group members</p><br><br>

    <h3>Step 3: Create and Link a new GPO</h3>
    <p><strong>1.</strong> Open <strong>Group Policy Management (gpmc.msc)</strong></p>
    <img src="Images/SG6.PNG" alt="SG6.PNG" style="width:400px; height:650px;"><br>
    <p><strong>2.</strong> Right-click the OU where the users reside in and select:</p>
    <p><strong>"Create a GPO in this domain, and Link it here..."</strong></p>
    <img src="Images/SG8.PNG" alt="SG8.PNG">
    <p><strong>3.</strong> Name the GPO (e.g., <strong>Disable Control Panel</strong></p>
    <img src="Images/SG9.PNG" alt="SG9.PNG" style="width:500px; height:200px;">
    <p><strong>4.</strong> Right-click the new GPO > <strong>Edit</strong>, and configure your desired settings.</p>
    <img src="Images/SG10.PNG" alt="SG10.PNG">
    <img src="Images/SG12.PNG" alt="SG12.PNG">
    <img src="Images/SG13.PNG" alt="SG13.PNG">
    <p><strong>Result:</strong> GPO is created and linked</p><br><br>

    <h3>Step 4: Apply GPO to Security Group Using Security Filtering</h3>
    <p><strong>1.</strong> In Group Policy Management, select your new GPO</p>
    <img src="Images/SG15.PNG" alt="SG15.PNG">
    <p><strong>2.</strong> In the <strong>Scope</strong> tab, under <strong>Security Filtering:</strong></p>
    <ul>
        <li><strong>Remove</strong> Authenticated Users</li>
        <li><strong>Add</strong> the group you created (e.g., <strong>Group_Policy_Users</strong>)</li>
    </ul>
    <img src="Images/SG16.PNG" alt="SG16.PNG">
    <img src="Images/SG17.PNG" alt="SG17.PNG">
    <p><strong>Result:</strong> The GPO will now <strong>only apply</strong> to members of that group.</p><br>

    <h4>Important: Verify Group Has "Read" and "Apply Group Policy" Permissions</h4>
    <p><strong>1.</strong> Still in GPMC, go to the <strong>Delegation</strong> tab of the GPO</p>
    <p><strong>2.</strong> Click <strong>Advanced</strong></p>
    <img src="Images/SG19.PNG" alt="SG19.PNG">
    <p><strong>3.</strong> Confirm that group has these permissions</p>
    <ul>
        <li><strong>Read</strong></li>
        <li><strong>Apply group policy</strong></li>
    </ul>
    <img src="Images/SG20.PNG" alt="SG20.PNG"><br><br>

    <h3>Step 5: Update and Test</h3>
    <ul>
        <li>On a client machine run, <strong>gupdate /force</strong></li>
        <li>Log in as a user inside the group - verify the GPO applies</li>
        <li>Log in as a user not in the group - verify the GPO does not apply</li>
    </ul>

    <p>This method provides you with the precise control over who receives the GPO, using Security Groups instead of broad OU application.l</p>
    

    
    
    
    
    

    


  <a href="../index.html">Back to Home</a>
</body>
</html>
