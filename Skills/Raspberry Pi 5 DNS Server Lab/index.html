<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Raspberry Pi 5 DNS Server Lab · Mark Thompson Portfolio</title>
  <meta name="description" content="A complete Raspberry Pi 5 DNS Server Lab demonstrating two DNS implementations: dnsmasq and BIND9. Includes configuration, testing, and verification screenshots." />
  <style>
    :root {
      --bg-1:#0f1115; --bg-2:#141821; --text:#E6E7EE; --muted:#A9ADBE;
      --brand:#4DA3FF; --card-border:#2A3447; --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
    }
    html, body {height:100%}
    body {
      margin:0; color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans";
      background:
        radial-gradient(1200px 800px at 30% -20%, #1a2233 0%, transparent 70%),
        radial-gradient(1200px 800px at 90% -10%, #0e1c2f 0%, transparent 70%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      line-height:1.6; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    .wrap{max-width:1000px;margin:0 auto;padding:40px 20px 64px}

    /* Top nav - INCREASED SIZE */
    .topnav{margin:0 0 24px;display:flex;gap:18px;flex-wrap:wrap}
    .topnav a{
      color:var(--muted);
      text-decoration:none;
      padding:12px 20px;
      border-radius:12px;
      border:1px solid transparent;
      font-size:16px;
      font-weight:500;
    }
    .topnav a:hover{color:var(--text);border-color:#2a3447;background:rgba(255,255,255,.04)}
    .topnav a.active{color:var(--text);border-color:#3a4a67;background:rgba(255,255,255,.06)}

    /* Headings - INCREASED SIZES */
    h1{font-size:clamp(32px,4.5vw,44px);font-weight:800;margin:8px 0 8px}
    h2{margin:0 0 14px;font-size:26px;font-weight:700}
    h3{margin:20px 0 10px;font-size:22px;font-weight:700}
    .lead{color:var(--muted);margin:10px 0 18px;font-size:clamp(17px,2.4vw,19px)}

    /* Body text - INCREASED SIZE */
    p{font-size:16px;line-height:1.65;margin:12px 0}
    ul,ol{font-size:16px;line-height:1.65;padding-left:24px;margin:10px 0}
    li{margin:6px 0}

    /* Cards - INCREASED PADDING */
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
      border:1px solid var(--card-border);border-radius:var(--radius);
      box-shadow:var(--shadow);padding:26px;margin-top:20px
    }

    /* Figures */
    .figure{
      border:1px solid var(--card-border);
      border-radius:12px;
      background:#0e1220;
      padding:10px;
      margin:16px auto;
      width:max-content;
      max-width:100%;
    }
    .figure img{
      display:block;
      height:auto;
      max-width:100%;
    }

    /* Code - INCREASED SIZE */
    pre{
      margin:14px 0;
      padding:16px 18px;
      background:#0f1424;
      border:1px solid #202a3f;
      border-radius:12px;
      overflow:auto;
      color:#e8eaf6;
      font:500 14.5px/1.6 ui-monospace,SFMono-Regular,Menlo,Consolas,Monaco,"Courier New",monospace;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.02);
    }
    code{
      background:#0f1424;border:1px solid #202a3f;border-radius:6px;
      padding:3px 7px;color:#e8eaf6;font:500 14.5px ui-monospace,SFMono-Regular,Menlo,Consolas,Monaco,"Courier New",monospace;
    }

    /* Links */
    a {
      color: var(--brand);
      text-decoration: none;
      transition: color 0.2s;
    }
    a:hover {
      color: var(--brand);
      text-decoration: underline;
    }
    .card > p > a {
      border-bottom: none;
    }
    .card > p > a:hover {
      text-decoration: underline;
    }

    /* Footer - MATCHING MAIN PAGE */
    footer{
      margin-top:48px;
      padding-top:24px;
      padding-bottom:2px;
      border-top:1px solid #232a3a;
      color:var(--muted);
      font-size:0.9rem;
      background:linear-gradient(
        to bottom,
        rgba(20,24,33,0) 0%,
        rgba(20,24,33,0.65) 100%
      );
      flex-shrink:0;
    }
    footer .links{
      margin-top:6px;
      gap:8px;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
    }
    footer a {
      color: var(--muted);
      border-bottom: none;
      text-decoration:none;
      white-space:nowrap;
    }
    footer a:hover {
      color: var(--brand);
    }

    /* Image zoom */
    .zoomable{cursor:zoom-in}
    .zoom-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.8);z-index:9999;padding:24px}
    .zoom-overlay.open{display:flex}
    .zoom-overlay img{max-width:min(1200px,94vw);max-height:90vh;border-radius:12px;box-shadow:var(--shadow);cursor:zoom-out}
    body.zoom-open{overflow:hidden}
  </style>
</head>
<body>
 
  <div class="wrap">
    <!-- Site nav -->
    <nav class="topnav" aria-label="Sections">
      <a href="/MTPortfolio/">Home</a>
      <a href="/MTPortfolio/Skills" class="active">Networking</a>
      <a href="/MTPortfolio/Current%20Projects%20&%20Studies/">Windows &amp; Linux</a>
      <a href="/MTPortfolio/Lab%20Projects">Cybersecurity</a>
      <a href="/MTPortfolio/Blogs">Blog</a>
    </nav>
  
    <h1>Raspberry Pi 5 DNS Server Lab</h1>
    <p class="lead">The <strong>Domain Name System (DNS)</strong> is a core part of how networks operate. It translates 
human-readable domain names into logical IP addresses (and vice versa). Allowing 
computers and devices to locate and communicate with one another across a network or 
the internet.</p> 
    <p class="lead">This lab demonstrates how to configure a Raspberry Pi 5 as a DNS server using both <strong>DNSMasq</strong> and <strong>BIND9</strong>. Each implementation is documented step-by-step, including setup, configuration, and validation.</p>

    <p>
      <a href="https://github.com/mark-thompson01/raspberry-pi-5-dns-server-lab/blob/main" target="_blank" rel="noopener">
        View this project on GitHub
      </a>
    </p>
    
    <!-- PART 1 -->
    <section class="card">
      <h2>Part 1: Configuring DNSMasq</h2>
      <p><strong>DNSMasq</strong> is a lightweight DNS forwarder and DHCP server suitable for small environments. It's efficient, simple to configure, and ideal for local caching.</p>
      
      <p><strong>1.</strong> Begin with updating software packages on Raspberry Pi with apt package manager.</p>
      <div class="figure"><img src="Images/rpdns1.png" alt="Installing dnsmasq"></div>
      <p><strong>2.</strong> Install the <strong>DNSMasq</strong> DNS software on the Raspberry Pi with apt package manager.</p>
      <div class="figure"><img src="Images/rpdns2.png" alt="Editing dnsmasq config"></div>
      <p><strong>3.</strong> Configure <strong>DNSMasq:</strong></p>
      <div class="figure"><img src="Images/rpdns3.png" alt="Configuring no-resolv"></div>
      <p>Here in the <strong>nano</strong> text editor, use <strong>CTRL + W</strong> to search and locate the following lines by removing the hash sign (#).</p>
      <div class="figure"><img src="Images/rpdns4.png" alt="Adding Cloudflare DNS"></div>
      <p><strong>#domain-needed</strong></p>
      <div class="figure"><img src="Images/rpdns5.png" alt="Setting cache size"></div>
      <div class="figure"><img src="Images/rpdns6.png" alt="Saving configuration"></div>
      <div class="figure"><img src="Images/rpdns7.png" alt="Restarting dnsmasq service"></div>
      <p><strong>#bogus-priv</strong></p>
      <div class="figure"><img src="Images/rpdns8.png" alt="Testing from Windows client"></div>
      <div class="figure"><img src="Images/rpdns9.png" alt="Testing DNS resolution"></div>
      <div class="figure"><img src="Images/rpdns10.png" alt="Verifying configuration"></div>
      <p><strong>#no-resolve</strong></p>
      <div class="figure"><img src="Images/rpdns11.png" alt="Verifying DNS query results"></div>
      <div class="figure"><img src="Images/rpdns12.png" alt="Verifying dnsmasq logs"></div>
      <p><strong>#server=/local/192.168.0.1</strong></p>
      <div class="figure"><img src="Images/rpdns13.png" alt="Checking DNS configuration file"></div>
      <div class="figure"><img src="Images/rpdns14.png" alt="Testing network connectivity"></div>
      <p><strong>#cache-size=150</strong></p>
      <div class="figure"><img src="Images/rpdns15.png" alt="Reviewing DNS cache entries"></div>
      <div class="figure"><img src="Images/rpdns16.png" alt="DNS query validation"></div>
      <p><strong>4.</strong> Restart the <strong>dnsmasq</strong> service and verify the status.</p>
      <div class="figure"><img src="Images/rpdns17.png" alt="Testing local domain"></div>
      <p><strong>5.</strong> Configure Windows 11 Lab-Client with Raspberry Pi IP address as Preferred DNS Server.</p>
      <div class="figure"><img src="Images/rpdns18.png" alt="Restarting network services"></div>
      <p><strong>6.</strong> Run <strong>nslookup</strong> command to test out DNS server functionality with <strong>DNSMasq</strong> running on the Raspberry Pi.</p>
      <div class="figure"><img src="Images/rpdns19.png" alt="Final dnsmasq verification"></div>
      
      <p>After configuration, the Raspberry Pi successfully caches DNS queries and forwards requests to Cloudflare's 1.1.1.1 and 1.0.0.1 servers.</p>
      <p>From here, the Raspberry Pi IP address can be added as the DNS server IP on other devices.</p>
    </section>

    <!-- PART 2 -->
    <section class="card">
      <h2>Part 2: Configuring BIND9</h2>
      <p><strong>BIND9</strong> is a robust DNS server supporting authoritative and recursive resolution. This setup transforms the Raspberry Pi 5 into a local DNS authority for <code>home.lan</code> while forwarding external lookups to Cloudflare.</p>

      <h3>Static IP Configuration</h3>
      <p>To begin, the Raspberry Pi needs to be configured with a <strong>Static IP</strong> address.
      In order to do that, we need to systematically identify how networking is managed on the given Raspberry
      Pi OS.</p>
      <p>Setting this up will ensure the Raspberry Pi retains the same IP address after rebooting, enabling reliable DNS, SSH, and other network services. </p>

      <p><strong>1. Identify the OS Version</strong></p>
      <p>Learn which networking framework the OS uses.</p>
      <p>Here we see the OS Version Raspberry Pi OS Bookworm. This means the OS Version uses <strong>NetworkManager</strong> as the networking framework.</p>
      <div class="figure"><img src="Images/checkOSVersion.png" alt="Check OS version"></div>

      <p><strong>2. Verify Which Network Service Is Active</strong></p>
      <p>Confirm that <strong>NetworkManager</strong> is indeed running and controlling interfaces.</p>
      <p>If it wasn't active, the configuration file <strong>/etc/dhcpcd.conf</strong> would be modified instead.</p>
      <p>This prevents misconfigurations caused by editing the wrong files.</p>
      <div class="figure"><img src="Images/2IdentifyService.png" alt="Identify service"></div>
      
      <p><strong>3. List Active Network Connections</strong></p>
      <p>Discover the connection profile (e.g., "Wired Connection 1" or "WLAN connection 1").</p>
      <p>You must know this name before modifying or applying static IP settings.</p>
      <div class="figure"><img src="Images/3nmcliconshow.png" alt="NetworkManager connections"></div>

      <p><strong>4. Check Current Network Interface and IP</strong></p>
      <p>To confirm which interface (e.g., eth0, wlan0) is active and what IP/subnet the Pi currently uses.</p>
      <p>This ensures your static IP stays in the same valid range and avoids conflicts.</p>
      <p>In this example, I'm only using the command hostname -I, in other cases running ip a would be necessary.</p>
      <div class="figure"><img src="Images/4hostname.png" alt="Check hostname"></div>

      <p><strong>5. Inspect Connection Settings</strong></p>
      <p>Verify whether the current IPv4 method is <strong>auto</strong> (DHCP).</p>
      <p>You need to switch it to <strong>manual</strong> before applying a static address.</p>
      <p>This step validates your assumptions before changing configuration.</p>
      <div class="figure"><img src="Images/5InspectSettings.png" alt="Inspect network settings"></div>

      <p><strong>6. Apply Static IP Configuration</strong></p>
      <p>To explicitly define:</p>
      <ul>
        <li>The Pi's static IP (IPv4.addresses)</li>
        <li>Its gateway (IPv4.gateway)</li>
        <li>Its DNS servers (ipv4.dns)</li>
        <li>And the connection method (ipv4.method manual)</li>
      </ul>
      <p>This makes the Pi use a fixed IP address that won't change after reboots - critical for consistent DNS, SSH, or web service operations.</p>
      <div class="figure"><img src="Images/6ApplyStatic.png" alt="Apply static IP"></div>

      <p><strong>7. Verify Connectivity and Persistence</strong></p>
      <p>Confirm that the Pi is reachable at its new static IP and still has internet access through the gateway.</p>
      <p>This validation ensures that the configuration was applied correctly and is functioning as expected.</p>
      <div class="figure"><img src="Images/7verify1.png" alt="Verify IP config 1"></div>
      <p>Here at the bottom we see <strong>valid_lft forever preferred_lft forever</strong>
      indicating that this is a <strong>static IP</strong> configuration.</p>
      <div class="figure"><img src="Images/7verify2.png" alt="Verify IP config 2"></div>
      <p>Re-verify that the current Ipv4 method <strong>ipv4.method</strong> is set to <strong>manual</strong>.</p>
      <div class="figure"><img src="Images/7verify3.png" alt="Verify IP config 3"></div>
      <p>Verify connectivity:</p>
      <div class="figure"><img src="Images/7verify4.png" alt="Verify IP config 4"></div>

      <h3>Installing and configuring BIND9</h3>
      <p><strong>1. Installing BIND9</strong></p>
      <p>Now that the Raspberry Pi is configured with a Static IP address, we can install BIND.</p>
      <p>In this example, I'm installing the program <strong>bind9</strong> and <strong>bind9utils</strong>.</p>
      <p>The <strong>bind9utils</strong> is not required, but does contain some useful tools for managing the DNS server.</p>
      <div class="figure"><img src="Images/Part2-1.png" alt="Installing BIND9"></div>

      <p>Here, I'm setting up a <strong>forward lookup</strong> and <strong>reverse lookup</strong> zone.</p>
      <div class="figure"><img src="Images/Part2-2.png" alt="Opening named.conf.local"></div>
      <div class="figure"><img src="Images/Part2-3.png" alt="Zone configuration"></div>

      <p><strong>2. Specify Configuration Settings</strong></p>
      <p>The zones are specified in the <strong>/etc/bind/named.conf.local</strong> file.</p>
      <p>With the zones set in the configuration file, the individual zone files need to be created like so.</p>
      <p><strong>Forward Lookup Zone:</strong></p>
      <div class="figure"><img src="Images/db.home.lan.png" alt="Creating db.home.lan 1"></div>
      <div class="figure"><img src="Images/Part2-4.png" alt="Creating db.home.lan 2"></div>
      <p><strong>Reverse Lookup Zone:</strong></p>
      <div class="figure"><img src="Images/Part2-5.png" alt="Editing reverse zone"></div>
      <div class="figure"><img src="Images/Part2-6.png" alt="PTR records"></div>
      <p><strong>Options:</strong></p>
      <div class="figure"><img src="Images/Part2-7.png" alt="Configuring named.conf.options"></div>
      <p>Here, I'm going to set the Forwarders to two of Cloudflare's DNS servers.</p>
      <p>With a DNS server now setup on the Raspberry Pi, the Raspberry Pi device now functions as a cache
      of DNS queries. As soon as the device queries a successful name resolution, that entry remains saved
      on the Raspberry Pi DNS server.</p>
      <p>In this setup the DNS queries are still being forwarded to another DNS server.</p>
      <p>The DNS server IP can be modified in the <strong>/etc/bind/named.conf.options</strong>
      by opening the file and changing the IP address in the <strong>Forwarders</strong> entry.</p>
      <div class="figure"><img src="Images/Part2-8.png" alt="Adding forwarders"></div>
      <div class="figure"><img src="Images/Part2-9.png" alt="Restart BIND9 service"></div>
      <p><strong>3. Restart bind9 service & verify functionality</strong></p>
      <p>And this is how you setup a DNS server with <strong>BIND</strong> on a Raspberry Pi 5.</p>
      <p>For the configuration changes to take effect, restart <strong>bind9</strong> like so 
      after verifying the configuration.</p>
      <div class="figure"><img src="Images/Part2-10.png" alt="Verify forwarders configuration"></div>
      <div class="figure"><img src="Images/Part2-11.png" alt="BIND9 status"></div>
      <p><strong>Verification:</strong></p>
      <div class="figure"><img src="Images/Part2-12.png" alt="Testing with dig"></div>

      <p>The BIND9 configuration includes both forward and reverse zone definitions, along with Cloudflare's DNS for external resolution. Successful testing with <code>dig</code> confirms the DNS server's proper function.</p>
    </section>

    <!-- PART 3 -->
    <section class="card">
      <h2>Part 3: Results and Key Takeaways</h2>
      <p>Both DNS implementations demonstrate how the Raspberry Pi 5 can serve as a powerful and flexible DNS solution for lab or production networks.</p>
      <ul>
        <li><strong>DNSMasq:</strong> Simple and efficient DNS forwarder with minimal setup.</li>
        <li><strong>BIND9:</strong> Full-featured DNS server supporting zones, reverse lookups, and recursive queries.</li>
      </ul>
      <p>This project demonstrates local name resolution, forward and reverse zone management, and verification using <code>dig</code> and <code>systemctl</code>. The lab also reinforces the importance of DNS in network infrastructure and the versatility of the Raspberry Pi 5.</p>
    </section>

    <section class="card">
      <p><a href="../index.html">Back to Home</a></p>
    </section>

    <footer>
      <div>Mark Thompson · MTPortfolio</div>
      <div class="links">
        <a href="https://www.linkedin.com/in/mark-thompson-9361a81a9/" target="_blank">LinkedIn</a> ·
        <a href="https://github.com/mark-thompson01" target="_blank" rel="noopener">GitHub</a>
      </div>
    </footer>
  </div>

  <script>
    (function(){
      const imgs=document.querySelectorAll('.wrap img');
      if(!imgs.length)return;
      const overlay=document.createElement('div');
      overlay.className='zoom-overlay';
      overlay.setAttribute('aria-hidden','true');
      overlay.innerHTML='<img alt="">';
      document.body.appendChild(overlay);
      const ovImg=overlay.querySelector('img');
      function closeZoom(){overlay.classList.remove('open');document.body.classList.remove('zoom-open');ovImg.removeAttribute('src');}
      overlay.addEventListener('click',closeZoom);
      document.addEventListener('keydown',e=>{if(e.key==='Escape')closeZoom()});
      imgs.forEach(img=>{img.classList.add('zoomable');img.addEventListener('click',()=>{ovImg.src=img.currentSrc||img.src;overlay.classList.add('open');document.body.classList.add('zoom-open');},{passive:true});});
    })();
  </script>
</body>
</html>
